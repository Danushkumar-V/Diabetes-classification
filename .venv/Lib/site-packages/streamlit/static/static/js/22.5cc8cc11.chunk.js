/*! For license information please see 22.5cc8cc11.chunk.js.LICENSE.txt */
(this["webpackJsonpstreamlit-browser"]=this["webpackJsonpstreamlit-browser"]||[]).push([[22],{2850:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));class i{setStatus(e){return new i(this.name,this.size,this.id,e)}constructor(e,t,s,i){this.name=void 0,this.size=void 0,this.status=void 0,this.id=void 0,this.name=e,this.size=t,this.id=s,this.status=i}}},5140:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return q}));var i,r=s(66),a=s(165),o=s.n(a),n=s(27),l=s.n(n),c=s(0),d=s.n(c),h=s(13),u=s(52),p=s(51),g=s(116),m=s(115),f=s(162),b=s(12),j=s(2850),S=s(279),w=s(7),x=s.n(w),F=s(21);function I(e,t){switch(e){case i.XSMALL:return{padding:"".concat(t.spacing.twoXS," ").concat(t.spacing.sm),fontSize:t.fontSizes.sm};case i.SMALL:return{padding:"".concat(t.spacing.twoXS," ").concat(t.spacing.md)};case i.LARGE:return{padding:"".concat(t.spacing.md," ").concat(t.spacing.md)};default:return{padding:"".concat(t.spacing.xs," ").concat(t.spacing.md)}}}!function(e){e.XSMALL="xsmall",e.SMALL="small",e.MEDIUM="medium",e.LARGE="large"}(i||(i={}));const C=x()("div",{target:"ejtjsn20"})((({theme:e,width:t})=>({position:"relative",width:"100%",objectFit:"contain"})),""),O=x()("div",{target:"ejtjsn21"})((({theme:e,width:t})=>({backgroundColor:e.colors.secondaryBg,borderRadius:"".concat(e.radii.md," ").concat(e.radii.md," 0 0"),width:t,height:9*t/16,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"})),""),R=x()("p",{target:"ejtjsn22"})((({theme:e})=>({marginTop:e.spacing.sm,textAlign:"center"})),""),v=x()("img",{target:"ejtjsn23"})((({theme:e,opacity:t})=>({borderRadius:"".concat(e.radii.md," ").concat(e.radii.md," 0 0"),objectFit:"contain",opacity:t})),""),E=x()("a",{target:"ejtjsn24"})((({theme:e})=>({color:e.colors.primary,display:"block",textDecoration:"none"})),""),y=x()("span",{target:"ejtjsn25"})((({theme:e})=>({display:"flex",alignItems:"center"})),""),M=x()("div",{target:"ejtjsn26"})((({theme:e})=>({position:"absolute",top:e.spacing.lg,right:e.spacing.lg,zIndex:1,color:e.colors.fadedText40,mixBlendMode:"difference",opacity:.6})),""),P=(x()("div",{target:"ejtjsn27"})((({theme:e})=>({display:"flex"})),""),x()("div",{target:"ejtjsn28"})((({theme:e})=>({height:"fit-content",width:"100%",position:"absolute",bottom:0})),"")),T=x()("button",{target:"ejtjsn29"})((({theme:e})=>({position:"relative",display:"inline-flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundColor:e.colors.lightenedBg05,border:"1px solid ".concat(e.colors.fadedText10),borderRadius:"0 0 ".concat(e.radii.md," ").concat(e.radii.md),"&:hover":{borderColor:e.colors.primary,color:e.colors.primary},"&:active":{color:e.colors.white,borderColor:e.colors.primary,backgroundColor:e.colors.primary},"&:focus:not(:active)":{borderColor:e.colors.primary,color:e.colors.primary},"&:disabled, &:disabled:hover, &:disabled:active":{color:e.colors.fadedText40},fontWeight:e.fontWeights.normal,padding:"".concat(e.spacing.xs," ").concat(e.spacing.md),margin:0,lineHeight:e.lineHeights.base,color:"inherit",width:"100%",userSelect:"none","&:focus":{boxShadow:"0 0 0 0.2rem ".concat(Object(F.transparentize)(e.colors.primary,.5)),outline:"none"},...I(i.MEDIUM,e)})),"");var U=s(5);var L=function({disabled:e,onClick:t,children:s,progress:i}){return Object(U.jsxs)(T,{disabled:e||!1,onClick:t||(()=>{}),progress:i||null,children:[s,i&&Object(U.jsx)(P,{children:Object(U.jsx)(S.b,{value:i,size:S.a.EXTRASMALL,overrides:{Bar:{style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}},BarProgress:{style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}},BarContainer:{style:{borderTopLeftRadius:"0px",borderTopRightRadius:"0px"}}}})})]})},k=s(3752),D=s(17),N=s(210);let z;!function(e){e.USER="user",e.ENVIRONMENT="environment"}(z||(z={}));var _=({switchFacingMode:e})=>Object(U.jsx)(M,{children:Object(U.jsx)(p.d,{content:"Switch camera",placement:p.b.TOP_RIGHT,children:Object(U.jsx)(D.d,{kind:D.b.MINIMAL,onClick:e,children:Object(U.jsx)(u.a,{content:k.SwitchCamera,size:"twoXL",color:N.a.white})})})}),G=s(25),V=s(5070),A=s(5073),W=s.n(A);let X;!function(e){e.PENDING="pending",e.SUCCESS="success",e.ERROR="error"}(X||(X={}));const B=({width:e})=>Object(U.jsxs)(O,{width:e,children:[Object(U.jsx)(u.a,{size:"threeXL",color:N.a.gray60,content:r.Video}),Object(U.jsxs)(R,{children:["This app would like to use your camera.",Object(U.jsx)(E,{href:"https://support.google.com/chrome/answer/2693767",rel:"noopener noreferrer",target:"_blank",children:"Learn how to allow access."})]})]});var H=({handleCapture:e,width:t,disabled:s,clearPhotoInProgress:i,setClearPhotoInProgress:r,facingMode:a,setFacingMode:o})=>{const[n,l]=Object(c.useState)(X.PENDING),d=Object(c.useRef)(null);const h=Object(G.useTheme)();return Object(U.jsxs)(C,{width:t,children:[n===X.SUCCESS||s||i?V.isMobile&&Object(U.jsx)(_,{switchFacingMode:o}):Object(U.jsx)(B,{width:t}),Object(U.jsx)(O,{hidden:n!==X.SUCCESS&&!s&&!i,width:t,children:!s&&Object(U.jsx)(W.a,{audio:!1,ref:d,screenshotFormat:"image/jpeg",screenshotQuality:1,width:t,height:9*t/16,style:{borderRadius:"".concat(h.radii.md," ").concat(h.radii.md," 0 0")},onUserMediaError:()=>{l(X.ERROR)},onUserMedia:()=>{l(X.SUCCESS),r(!1)},videoConstraints:{width:{ideal:t},facingMode:a}})}),Object(U.jsx)(L,{onClick:function(){if(null!==d.current){const t=d.current.getScreenshot();e(t)}},disabled:n!==X.SUCCESS||s||i,children:"Take Photo"})]})};class J extends d.a.PureComponent{constructor(e){super(e),this.localFileIdCounter=1,this.RESTORED_FROM_WIDGET_STRING="RESTORED_FROM_WIDGET",this.formClearHelper=new f.b,this.getProgress=()=>{if(this.state.files.length>0&&"uploading"===this.state.files[this.state.files.length-1].status.type){return this.state.files[this.state.files.length-1].status.progress}},this.setClearPhotoInProgress=e=>{this.setState({clearPhotoInProgress:e})},this.setFacingMode=()=>{this.setState((e=>({facingMode:e.facingMode===z.USER?z.ENVIRONMENT:z.USER})))},this.handleCapture=e=>{if(null===e)return Promise.resolve();this.setState({imgSrc:e,shutter:!0,minShutterEffectPassed:!1});var t,s;return(t=e,s="camera-input-".concat((new Date).toISOString().replace(/:/g,"_"),".jpg"),fetch(t).then((e=>e.arrayBuffer())).then((e=>new File([e],s,{type:"image/jpeg"})))).then((e=>this.uploadFile(e))).then((()=>{return e=150,new Promise((t=>setTimeout(t,e)));var e})).then((()=>{this.setState({imgSrc:e,shutter:this.state.shutter,minShutterEffectPassed:!0})})).catch((e=>{Object(b.b)(e)}))},this.removeCapture=()=>{0!==this.state.files.length&&(this.state.files.forEach((e=>this.deleteFile(e.id))),this.setState({imgSrc:null,clearPhotoInProgress:!0}))},this.componentDidUpdate=e=>{const{element:t,widgetMgr:s}=this.props;if(e.disabled!==this.props.disabled&&this.props.disabled)return this.reset(),void s.setFileUploaderStateValue(t,new h.h,{fromUi:!1});if("ready"!==this.status)return;const i=this.createWidgetValue();if(void 0===i)return;const r=s.getFileUploaderStateValue(t);l.a.isEqual(i,r)||s.setFileUploaderStateValue(t,i,{fromUi:!0})},this.onFormCleared=()=>{this.setState({files:[]},(()=>{const e=this.createWidgetValue();null!=e&&(this.setState({imgSrc:null}),this.props.widgetMgr.setFileUploaderStateValue(this.props.element,e,{fromUi:!0}))}))},this.render=()=>{const{element:e,widgetMgr:t,disabled:s,width:i}=this.props;return this.formClearHelper.manageFormClearListener(t,e.formId,this.onFormCleared),Object(U.jsxs)(C,{width:i,className:"row-widget","data-testid":"stCameraInput",children:[Object(U.jsx)(m.d,{label:e.label,disabled:s,children:e.help&&Object(U.jsx)(m.b,{children:Object(U.jsx)(g.a,{content:e.help,placement:p.b.TOP_RIGHT})})}),this.state.imgSrc?Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)(O,{width:i,children:this.state.imgSrc!==this.RESTORED_FROM_WIDGET_STRING&&Object(U.jsx)(v,{src:this.state.imgSrc,alt:"Snapshot",opacity:this.state.shutter||!this.state.minShutterEffectPassed?"50%":"100%",width:i,height:9*i/16})}),Object(U.jsx)(L,{onClick:this.removeCapture,progress:this.getProgress(),disabled:!!this.getProgress()||s,children:this.getProgress()?"Uploading...":Object(U.jsxs)(y,{children:[Object(U.jsx)(u.a,{content:r.X,margin:"0 xs 0 0",size:"sm"})," Clear photo"]})})]}):Object(U.jsx)(H,{handleCapture:this.handleCapture,width:i,disabled:s,clearPhotoInProgress:this.state.clearPhotoInProgress,setClearPhotoInProgress:this.setClearPhotoInProgress,facingMode:this.state.facingMode,setFacingMode:this.setFacingMode})]})},this.deleteFile=e=>{const t=this.getFile(e);null!=t&&("uploading"===t.status.type&&t.status.cancelToken.cancel(),this.removeFile(e))},this.addFile=e=>{this.setState((t=>({files:[...t.files,e]})))},this.removeFile=e=>{this.setState((t=>({files:t.files.filter((t=>t.id!==e))})))},this.getFile=e=>this.state.files.find((t=>t.id===e)),this.updateFile=(e,t)=>{this.setState((s=>({files:s.files.map((s=>s.id===e?t:s))})))},this.onUploadComplete=(e,t)=>{this.setState((e=>({newestServerFileId:Math.max(e.newestServerFileId,t),shutter:!1})));const s=this.getFile(e);null!=s&&"uploading"===s.status.type&&this.updateFile(s.id,s.setStatus({type:"uploaded",serverFileId:t}))},this.onUploadProgress=(e,t)=>{const s=this.getFile(t);if(null==s||"uploading"!==s.status.type)return;const i=Math.round(100*e.loaded/e.total);s.status.progress!==i&&this.updateFile(t,s.setStatus({type:"uploading",cancelToken:s.status.cancelToken,progress:i}))},this.reset=()=>{this.setState({files:[],imgSrc:null})},this.uploadFile=e=>{const t=o.a.CancelToken.source(),s=new j.a(e.name,e.size,this.nextLocalFileId(),{type:"uploading",cancelToken:t,progress:1});this.addFile(s),this.props.uploadClient.uploadFile(this.props.element,e,(e=>this.onUploadProgress(e,s.id)),t.token).then((e=>this.onUploadComplete(s.id,e))).catch((e=>{o.a.isCancel(e)||this.updateFile(s.id,s.setStatus({type:"error",errorMessage:e?e.toString():"Unknown error"}))}))},this.state=this.initialValue}get initialValue(){const e={files:[],newestServerFileId:0,imgSrc:null,shutter:!1,minShutterEffectPassed:!0,clearPhotoInProgress:!1,facingMode:z.USER},{widgetMgr:t,element:s}=this.props,i=t.getFileUploaderStateValue(s);if(null==i)return e;const{maxFileId:r,uploadedFileInfo:a}=i;return null==r||0===r||null==a?e:{files:a.map((e=>{const t=e.name,s=e.size,i=e.id;return new j.a(t,s,this.nextLocalFileId(),{type:"uploaded",serverFileId:i})})),newestServerFileId:Number(r),imgSrc:0===a.length?"":this.RESTORED_FROM_WIDGET_STRING,shutter:!1,minShutterEffectPassed:!1,clearPhotoInProgress:!1,facingMode:z.USER}}componentWillUnmount(){this.formClearHelper.disconnect()}get status(){return this.state.files.some((e=>"uploading"===e.status.type))?"updating":"ready"}createWidgetValue(){if(0===this.state.newestServerFileId)return;const e=this.state.files.filter((e=>"uploaded"===e.status.type)).map((e=>{const{name:t,size:s,status:i}=e;return new h.t({id:i.serverFileId,name:t,size:s})}));return new h.h({maxFileId:this.state.newestServerFileId,uploadedFileInfo:e})}nextLocalFileId(){return this.localFileIdCounter++}}var q=J}}]);